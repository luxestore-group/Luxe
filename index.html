<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Luxe Store</title>
<script src="https://js.paystack.co/v1/inline.js"></script>
<style>
:root{--gold:#b8860b;--silver:#c0c0c0}
*{box-sizing:border-box}
body{margin:0;font-family:Arial,sans-serif;background:#fff8f0;color:#333;transition:.3s}
body.dark{background:#111;color:#fff}
header{background:linear-gradient(90deg,var(--gold),#fff,var(--silver));padding:14px;text-align:center}
body.dark header{background:linear-gradient(90deg,#444,#666,#999)}
h1{margin:0}
.header-actions{display:flex;justify-content:center;gap:10px;margin-top:8px}
.header-actions button{padding:6px 10px;border-radius:20px;border:none;font-weight:bold;cursor:pointer}

.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;padding:16px}
.card{background:#fff;border-radius:14px;box-shadow:0 4px 12px rgba(0,0,0,.2);overflow:hidden}
body.dark .card{background:#222}
.card img{width:100%;height:180px;object-fit:cover}
.card-body{text-align:center;padding:10px}
.price{font-weight:bold;color:var(--silver)}
.buttons{display:flex;gap:6px;flex-wrap:wrap}
.buttons button{flex:1 1 45%;padding:8px;border:none;border-radius:10px;font-weight:bold;cursor:pointer}
.buy{background:var(--gold);color:#fff}
.details{background:#c0c0c0}

.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);align-items:center;justify-content:center;z-index:1000}
.modal.show{display:flex}
.modal-box{background:#fff;color:#000;padding:16px;border-radius:14px;max-width:560px;width:95%;max-height:90vh;overflow:auto;position:relative}
body.dark .modal-box{background:#222;color:#fff}
.close{position:absolute;right:12px;top:8px;font-size:20px;cursor:pointer}

.gallery{display:flex;gap:8px;overflow-x:auto}
.gallery img{width:150px;height:150px;object-fit:cover;border-radius:10px;cursor:zoom-in;transition:.3s}
.gallery img.zoom{transform:scale(2);cursor:zoom-out}

.cart-item{display:flex;justify-content:space-between;align-items:center;margin:6px 0}
.cart-item button{padding:4px 8px}

.notice{font-size:.9rem;line-height:1.4}
.notice ul{padding-left:18px}
.notice li{margin-bottom:6px}

.pay{background:var(--gold);color:#fff;padding:10px;border:none;border-radius:10px;width:100%;font-weight:bold}
input, select{width:100%;padding:8px;margin:6px 0;border-radius:8px;border:1px solid #ccc}
.mtn-card img{background:#ffd700;padding:14px;object-fit:contain}
label{font-weight:bold;margin-top:10px;display:block}
</style>
</head>
<body>
<header>
  <h1>Luxe Store</h1>
  <div class="header-actions">
    <button id="cartBtn">ðŸ›’ Cart</button>
    <button id="themeBtn">Light / Dark</button>
    <button id="notifyBtn">ðŸ”” Notice</button>
  </div>
</header>

<div class="products">
  <!-- PHYSICAL PRODUCTS -->
  <div class="card" data-name="Silver Crest Blender 2in1 2.0L" data-price="300" data-images="images/blender.jpg,images/blenders.jpg,images/blender2.jpg">
    <img src="images/blender.jpg" />
    <div class="card-body">
      <h3>Silver Crest Blender 2-in1- 2.0L</h3>
      <p class="price">â‚µ300</p>
      <div class="buttons">
        <button class="buy">Add to Cart</button>
        <button class="details">More Details</button>
      </div>
    </div>
  </div>

  <div class="card" data-name="Superbass 2-in-1 Earphones" data-price="65" data-images="images/headphones.jpg,images/headphones1.jpg">
    <img src="images/headphones.jpg" />
    <div class="card-body">
      <h3>Superbass 2-in-1 Earphones</h3>
      <p class="price">â‚µ65</p>
      <div class="buttons">
        <button class="buy">Add to Cart</button>
        <button class="details">More Details</button>
      </div>
    </div>
  </div>

  <!-- MTN DATA BUNDLE CARD -->
  <div class="card mtn-card">
    <img src="images/databundles.jpg" />
    <div class="card-body">
      <h3>MTN Data Bundles</h3>
      <p class="price">â‚µ5.50 â€“ â‚µ60.00</p>
      <div class="buttons">
        <button class="buy" onclick="openMTNModal()">Select Bundle</button>
      </div>
    </div>
  </div>
</div>

<!-- CART MODAL -->
<div class="modal" id="cartModal">
  <div class="modal-box">
    <span class="close">Ã—</span>
    <h3>Your Cart</h3>
    <div id="cartItems"></div>
    <p><strong>Total:</strong> â‚µ<span id="cartTotal">0</span></p>
    <input id="custName" placeholder="Your name" required />
    <input id="custPhone" placeholder="Phone number" required />
    <input id="custEmail" placeholder="Email" />
    <button class="pay" id="checkoutBtn">Checkout & Pay</button>
  </div>
</div>

<!-- MTN BUNDLE MODAL -->
<div class="modal" id="mtnModal">
  <div class="modal-box">
    <span class="close">Ã—</span>
    <h3>Select MTN Data Bundle</h3>
    <label>Choose Bundle</label>
    <select id="mtnBundleSelect">
      <option value="5.5">1GB â€“ â‚µ5.50</option>
      <option value="12">2GB â€“ â‚µ12</option>
      <option value="18">3GB â€“ â‚µ18</option>
      <option value="24">4GB â€“ â‚µ24</option>
      <option value="30">5GB â€“ â‚µ30</option>
      <option value="36">6GB â€“ â‚µ36</option>
      <option value="42">7GB â€“ â‚µ42</option>
      <option value="48">8GB â€“ â‚µ48</option>
      <option value="54">9GB â€“ â‚µ54</option>
      <option value="60">10GB â€“ â‚µ60</option>
    </select>
    <input id="mtnNumber" placeholder="MTN Number (e.g. 054xxxxxxx)" />
    <button class="pay" id="addMtnToCart">Add to Cart</button>
  </div>
</div>

<!-- NOTICE MODAL -->
<div class="modal" id="noticeModal">
  <div class="modal-box">
    <span class="close">Ã—</span>
    <h3>Must Read Before Purchase</h3>
    <div class="notice">
      <ul>
        <li>Thank you for joining our platform.</li>
        <li>All products are ready for delivery.</li>
        <li>Users must provide correct info before payment.</li>
        <li>TURBONET / MERCHANT / BROADBAND SIMs do not work for data bundles.</li>
        <li>Bundles purchased for wrong numbers are non-refundable.</li>
        <li>Data bundle delivery is 30 minutes to 1 hour.</li>
        <li>For urgent bundles dial <strong>*138#</strong>.</li>
      </ul>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCZdOPS1D0pSW8jYjL1p7Q9JpES06Pc-UE",
  authDomain: "luxe-5a8e8.firebaseapp.com",
  projectId: "luxe-5a8e8",
  storageBucket: "luxe-5a8e8.firebasestorage.app",
  messagingSenderId: "178257618326",
  appId: "1:178257618326:web:3c6c26f267dfcf73d3e9b7"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
</script>

<script>
// THEME TOGGLE
document.getElementById('themeBtn').onclick = ()=>document.body.classList.toggle('dark');

// CART LOGIC
let cart = [];
const cartModal = document.getElementById('cartModal');
const cartItems = document.getElementById('cartItems');
const cartTotal = document.getElementById('cartTotal');

function renderCart(){
  cartItems.innerHTML = '';
  let total=0;
  cart.forEach((item,idx)=>{
    total += item.price * item.qty;
    cartItems.innerHTML += `<div class="cart-item">${item.name} x${item.qty} 
      <div>
        <button onclick='inc(${idx})'>+</button>
        <button onclick='dec(${idx})'>-</button>
      </div>
    </div>`;
  });
  cartTotal.textContent = total;
}

// CART INC/DEC
window.inc = i=>{cart[i].qty++; renderCart();}
window.dec = i=>{cart[i].qty>1?cart[i].qty--:cart.splice(i,1); renderCart();}

// PHYSICAL PRODUCTS
document.querySelectorAll('.card').forEach(card=>{
  const name = card.dataset.name;
  const price = Number(card.dataset.price||0);
  if(card.querySelector('.buy')&&!card.classList.contains('mtn-card')){
    card.querySelector('.buy').onclick=()=>{
      cart.push({name,price,qty:1});
      renderCart(); cartModal.classList.add('show');
    }
  }
});

// MTN BUNDLE MODAL
function openMTNModal(){document.getElementById('mtnModal').classList.add('show')}
document.getElementById('addMtnToCart').onclick=()=>{
  const select = document.getElementById('mtnBundleSelect');
  const price = Number(select.value);
  const text = select.selectedOptions[0].text;
  const number = document.getElementById('mtnNumber').value.trim();
  if(!number || number.length<9){alert('Enter a valid MTN number'); return;}
  cart.push({name:'MTN '+text+' ('+number+')', price, qty:1, mtn:true});
  renderCart();
  document.getElementById('mtnModal').classList.remove('show');
  document.getElementById('mtnNumber').value='';
  cartModal.classList.add('show');
}

// PAYSTACK CHECKOUT
document.getElementById('checkoutBtn').onclick=()=>{
  const total = Number(cartTotal.textContent);
  const name = document.getElementById('custName').value || 'Guest';
  const phone = document.getElementById('custPhone').value || '0000000000';
  const email = document.getElementById('custEmail').value || 'guest@example.com';
  if(!total){alert('Cart is empty'); return;}
  const handler = PaystackPop.setup({
    key:'pk_live_98575428080557d261e91cb92fe745f878fc4278',
    email, amount:total*100, currency:'GHS',
    metadata:{custom_fields:[
      {display_name:"Name", variable_name:"name", value:name},
      {display_name:"Phone", variable_name:"phone", value:phone},
      {display_name:"MTN Bundles", variable_name:"bundles", value:JSON.stringify(cart.filter(c=>c.mtn))}
    ]},
    callback: async res=>{
      await addDoc(collection(db,'orders'), {cart, amount:total, ref:res.reference, time:serverTimestamp()});
      alert('Payment successful'); cart=[]; renderCart(); cartModal.classList.remove('show');
    },
    onClose:()=>alert('Payment cancelled')
  });
  handler.openIframe();
}

// MODAL CONTROLS
document.getElementById('cartBtn').onclick=()=>cartModal.classList.add('show');
document.getElementById('notifyBtn').onclick=()=>document.getElementById('noticeModal').classList.add('show');
document.querySelectorAll('.close').forEach(c=>c.onclick=()=>document.querySelectorAll('.modal').forEach(m=>m.classList.remove('show')));
</script>
</body>
  </html>
